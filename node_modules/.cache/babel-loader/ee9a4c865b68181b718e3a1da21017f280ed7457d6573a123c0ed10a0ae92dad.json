{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link}from\"react-router-dom\";import axios from'axios';import'./style/Menu.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function PizzaMenu(_ref){let{user}=_ref;const[pizzas,setPizzas]=useState([]);const[searchTerm,setSearchTerm]=useState('');useEffect(()=>{axios.get('https://pizzeriabackend-pizzeriabackendmk.azuremicroservices.io/api/pizzas').then(response=>setPizzas(response.data)).catch(error=>console.error(error));},[]);const handleDeletePizza=async pizzaId=>{try{await axios.delete(\"https://pizzeriabackend-pizzeriabackendmk.azuremicroservices.io/api/pizzas/\".concat(pizzaId));const response=await axios.get('/api/pizzas');setPizzas(response.data);}catch(error){console.error('Błąd',error);}};const handleAddToCart=async pizzaId=>{try{const response=await axios.post(\"https://pizzeriabackend-pizzeriabackendmk.azuremicroservices.io/api/users/addPizza?pizzaId=\".concat(pizzaId,\"&username=\").concat(user.username));console.log('Pizza added to cart:',response.data);alert('Pizza dodana do Koszyka');}catch(error){console.error('Error adding pizza to cart:',error);alert('Nie można dodać Pizzy do koszyka');}};const handleChange=event=>{setSearchTerm(event.target.value);};const handleSearchPizza=async event=>{event.preventDefault();try{const response=await axios.post(\"https://pizzeriabackend-pizzeriabackendmk.azuremicroservices.io/api/pizzas/searchPizza?searchText=\".concat(searchTerm));setPizzas(response.data);}catch(error){console.error('Błąd podczas wyszukiwania pizzy:',error);}};const handleDownloadImage=imageName=>{axios({url:\"https://pizzeriabackend-pizzeriabackendmk.azuremicroservices.io/api/pizzas/downloadImage?imageName=\".concat(imageName,\".jpg\"),method:'GET',responseType:'blob'// Important\n}).then(response=>{const url=window.URL.createObjectURL(new Blob([response.data],{type:'image/jpeg'}));const link=document.createElement('a');link.href=url;link.setAttribute('download',imageName);document.body.appendChild(link);link.click();link.parentNode.removeChild(link);}).catch(error=>{console.error('Błąd podczas pobierania obrazu:',error);});};return/*#__PURE__*/_jsx(\"center\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Menu\"}),/*#__PURE__*/_jsxs(\"h3\",{children:[/*#__PURE__*/_jsx(Link,{to:\"/menu\",children:\"Pizze\"}),\" | \",/*#__PURE__*/_jsx(Link,{to:\"/menuNapoje\",children:\"Napoje\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearchPizza,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Nazwa:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"nazwa\",value:searchTerm,onChange:handleChange})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Szukaj\"})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"menu-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Nazwa\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Cena\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Rozmiar\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Wegetaria\\u0144ska\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Czy Dost\\u0119pna\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:pizzas.map(pizza=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:pizza.nazwa}),/*#__PURE__*/_jsxs(\"td\",{children:[pizza.cena,\" PLN\"]}),/*#__PURE__*/_jsx(\"td\",{children:pizza.rozmiar}),/*#__PURE__*/_jsx(\"td\",{children:pizza.czyWegetarianska?'Tak':'Nie'}),/*#__PURE__*/_jsx(\"td\",{children:pizza.czyDostepna?'Tak':'Nie'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"ButtonPizza\",onClick:()=>handleDownloadImage(pizza.nazwa),children:\"Pobierz\"})}),user&&pizza.czyDostepna&&/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"ButtonPizza\",onClick:()=>handleAddToCart(pizza.id),children:\"Dodaj do Koszyka\"})}),user&&user.username==='admin'&&/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"ButtonPizza\",onClick:()=>handleDeletePizza(pizza.id),children:\"Usu\\u0144\"})}),user&&user.username==='admin'&&/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Link,{to:\"/editpizza/\".concat(pizza.id),className:\"ButtonPizza\",children:\"Edytuj\"})})]},pizza.id))})]}),user&&user.username==='admin'&&/*#__PURE__*/_jsx(Link,{to:\"/addpizza\",class:\"ButtonPizza\",children:\"Dodaj Pizze\"})]})});};export default PizzaMenu;","map":{"version":3,"names":["React","useState","useEffect","Link","axios","jsx","_jsx","jsxs","_jsxs","PizzaMenu","_ref","user","pizzas","setPizzas","searchTerm","setSearchTerm","get","then","response","data","catch","error","console","handleDeletePizza","pizzaId","delete","concat","handleAddToCart","post","username","log","alert","handleChange","event","target","value","handleSearchPizza","preventDefault","handleDownloadImage","imageName","url","method","responseType","window","URL","createObjectURL","Blob","type","link","document","createElement","href","setAttribute","body","appendChild","click","parentNode","removeChild","children","to","onSubmit","name","onChange","className","map","pizza","nazwa","cena","rozmiar","czyWegetarianska","czyDostepna","onClick","id","class"],"sources":["C:/Users/user/Desktop/Projekt KPCH/Frontend/myapp/src/pages/PizzaMenu.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Link } from \"react-router-dom\";\r\nimport axios from 'axios';\r\nimport './style/Menu.css';\r\n\r\nfunction PizzaMenu({ user }) {\r\n    const [pizzas, setPizzas] = useState([]);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n\r\n    useEffect(() => {\r\n        axios.get('https://pizzeriabackend-pizzeriabackendmk.azuremicroservices.io/api/pizzas')\r\n            .then(response => setPizzas(response.data))\r\n            .catch(error => console.error(error));\r\n    }, []);\r\n\r\n    const handleDeletePizza = async (pizzaId) => {\r\n        try {\r\n          await axios.delete(`https://pizzeriabackend-pizzeriabackendmk.azuremicroservices.io/api/pizzas/${pizzaId}`);\r\n          const response = await axios.get('/api/pizzas');\r\n          setPizzas(response.data);\r\n        } catch (error) {\r\n          console.error('Błąd', error);\r\n        }\r\n      };\r\n    \r\n\r\n      const handleAddToCart = async (pizzaId) => {\r\n        try {\r\n            const response = await axios.post(`https://pizzeriabackend-pizzeriabackendmk.azuremicroservices.io/api/users/addPizza?pizzaId=${pizzaId}&username=${user.username}`);\r\n            console.log('Pizza added to cart:', response.data);\r\n            alert('Pizza dodana do Koszyka');\r\n        } catch (error) {\r\n            console.error('Error adding pizza to cart:', error);\r\n            alert('Nie można dodać Pizzy do koszyka');\r\n        }\r\n    };\r\n\r\n\r\n    const handleChange = (event) => {\r\n        setSearchTerm(event.target.value);\r\n    };\r\n\r\n    const handleSearchPizza = async (event) => {\r\n        event.preventDefault();\r\n        \r\n        try {\r\n            const response = await axios.post(`https://pizzeriabackend-pizzeriabackendmk.azuremicroservices.io/api/pizzas/searchPizza?searchText=${searchTerm}`);\r\n            setPizzas(response.data);\r\n        } catch (error) {\r\n            console.error('Błąd podczas wyszukiwania pizzy:', error);\r\n        }\r\n    };\r\n\r\n\r\n\r\n    const handleDownloadImage = (imageName) => {\r\n        axios({\r\n            url: `https://pizzeriabackend-pizzeriabackendmk.azuremicroservices.io/api/pizzas/downloadImage?imageName=${imageName}.jpg`,\r\n            method: 'GET',\r\n            responseType: 'blob', // Important\r\n        }).then((response) => {\r\n            const url = window.URL.createObjectURL(new Blob([response.data], { type: 'image/jpeg' }));\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.setAttribute('download', imageName);\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            link.parentNode.removeChild(link);\r\n        }).catch((error) => {\r\n            console.error('Błąd podczas pobierania obrazu:', error);\r\n        });\r\n    };\r\n\r\n\r\n\r\n\r\n\r\n\r\n    return (\r\n        <center>\r\n        <div>\r\n        <h2>Menu</h2>\r\n        <h3><Link to=\"/menu\">Pizze</Link> | <Link to=\"/menuNapoje\">Napoje</Link></h3>\r\n\r\n        <form onSubmit={handleSearchPizza}>\r\n        <label>\r\n          Nazwa:\r\n          <input\r\n            type=\"text\"\r\n            name=\"nazwa\"\r\n            value={searchTerm}\r\n            onChange={handleChange}\r\n          />\r\n        </label>\r\n        <button type=\"submit\">Szukaj</button>\r\n        </form>\r\n\r\n\r\n\r\n\r\n        <table className=\"menu-table\">\r\n            <thead>\r\n                <tr>\r\n                    <th>Nazwa</th>\r\n                    <th>Cena</th>\r\n                    <th>Rozmiar</th>\r\n                    <th>Wegetariańska</th>\r\n                    <th>Czy Dostępna</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                {pizzas.map(pizza => (\r\n                    <tr key={pizza.id}>\r\n                        <td>{pizza.nazwa}</td>\r\n                        <td>{pizza.cena} PLN</td>\r\n                        <td>{pizza.rozmiar}</td>\r\n                        <td>{pizza.czyWegetarianska ? 'Tak' : 'Nie'}</td>\r\n                        <td>{pizza.czyDostepna ? 'Tak' : 'Nie'}</td>\r\n                        <td>\r\n                                <button className=\"ButtonPizza\" onClick={() => handleDownloadImage(pizza.nazwa)}>Pobierz</button>\r\n                        </td>\r\n                        {user && pizza.czyDostepna && (\r\n                            <td>\r\n                                <button className=\"ButtonPizza\" onClick={() => handleAddToCart(pizza.id)}>Dodaj do Koszyka</button>\r\n                            </td>\r\n                        )}\r\n                        {user && user.username === 'admin' && (<td>\r\n                        <button className=\"ButtonPizza\" onClick={() => handleDeletePizza(pizza.id)}>Usuń</button>\r\n                        </td>)}\r\n                        {user && user.username === 'admin' && (<td>\r\n                            <Link to={`/editpizza/${pizza.id}`} className=\"ButtonPizza\">Edytuj</Link>\r\n                        </td>)}\r\n                    </tr>\r\n                ))}\r\n            </tbody>\r\n        </table>\r\n        {user && user.username === 'admin' && <Link to=\"/addpizza\" class=\"ButtonPizza\">Dodaj Pizze</Link>}\r\n    </div>\r\n    \r\n    </center>\r\n);\r\n};\r\n    \r\n    export default PizzaMenu;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}